<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>OS Flow ‚Ä¢ Modelos de Garantia</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Paleta de Cores Profissional - Azul Claro como principal */
      --primary-50: #f0f9ff;
      --primary-100: #e0f2fe;
      --primary-200: #bae6fd;
      --primary-300: #7dd3fc;
      --primary-400: #38bdf8;
      --primary-500: #0ea5e9;
      --primary-600: #0284c7;
      --primary-700: #0369a1;
      --primary-800: #075985;
      --primary-900: #0c4a6e;

      /* Cores Sem√¢nticas */
      --success: #10b981;
      --success-light: #d1fae5;
      --warning: #f59e0b;
      --warning-light: #fef3c7;
      --danger: #ef4444;
      --danger-light: #fee2e2;
      --info: #0ea5e9;
      --info-light: #e0f2fe;
      --purple: #8b5cf6;
      --purple-light: #ede9fe;
      --teal: #14b8a6;
      --teal-light: #ccfbf1;

      /* Cores Neutras Profissionais */
      --gray-50: #f9fafb;
      --gray-100: #f3f4f6;
      --gray-200: #e5e7eb;
      --gray-300: #d1d5db;
      --gray-400: #9ca3af;
      --gray-500: #6b7280;
      --gray-600: #4b5563;
      --gray-700: #374151;
      --gray-800: #1f2937;
      --gray-900: #111827;

      /* Cores de Fundo */
      --bg-body: linear-gradient(135deg, #f8fafc 0%, #f0f9ff 100%);
      --bg-surface: #ffffff;
      --bg-surface-hover: #f8fafc;
      --bg-sidebar: rgba(255, 255, 255, 0.95);
      --bg-card: #ffffff;

      /* Cores de Texto */
      --text-primary: #111827;
      --text-secondary: #4b5563;
      --text-tertiary: #6b7280;
      --text-muted: #9ca3af;
      --text-inverse: #ffffff;

      /* Bordas */
      --border-light: #e5e7eb;
      --border-medium: #d1d5db;
      --border-accent: var(--primary-400);

      /* Sombras Profissionais */
      --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      --shadow-primary: 0 4px 14px 0 rgba(14, 165, 233, 0.2);

      /* Tipografia */
      --font-primary: 'Plus Jakarta Sans', system-ui, -apple-system, sans-serif;
      --font-secondary: 'Manrope', system-ui, -apple-system, sans-serif;
      --font-mono: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Mono', monospace;

      /* Espa√ßamento */
      --space-0: 0;
      --space-1: 0.25rem;
      --space-2: 0.5rem;
      --space-3: 0.75rem;
      --space-4: 1rem;
      --space-5: 1.25rem;
      --space-6: 1.5rem;
      --space-8: 2rem;
      --space-10: 2.5rem;
      --space-12: 3rem;
      --space-16: 4rem;

      /* Bordas */
      --radius-sm: 0.375rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --radius-xl: 1rem;
      --radius-2xl: 1.5rem;
      --radius-full: 9999px;

      /* Transi√ß√µes */
      --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);

      /* Layout */
      --sidebar-width: 260px;
      --sidebar-collapsed: 72px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: var(--font-secondary);
      background: var(--bg-body);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.5;
    }

    .layout {
      display: grid;
      grid-template-columns: var(--sidebar-width) 1fr;
      min-height: 100vh;
      transition: grid-template-columns var(--transition-base);
    }
    .layout.collapsed { grid-template-columns: var(--sidebar-collapsed) 1fr; }

    /* Sidebar */
    .sidebar-wrapper{
      position: sticky;
      top: 0;
      height: 100vh;
      background: var(--bg-sidebar);
      border-right: 1px solid var(--border-light);
      box-shadow: var(--shadow-md);
      z-index: 100;
      width: var(--sidebar-width);
      transition: all var(--transition-base);
      overflow: hidden;
    }
    .layout.collapsed .sidebar-wrapper { width: var(--sidebar-collapsed); }

    .sidebar { padding: var(--space-6) 0; display:flex; flex-direction:column; height:100%; }

    .sidebar-logo{
      padding: 0 var(--space-4) var(--space-6);
      display:flex; align-items:center; gap: var(--space-3);
      margin-bottom: var(--space-6);
      border-bottom:1px solid var(--border-light);
      padding-bottom: var(--space-6);
      min-height:60px;
    }
    .layout.collapsed .sidebar-logo { padding: 0 var(--space-3) var(--space-6); justify-content:center; }

    .sidebar-logo-icon{
      width:40px;height:40px;border-radius:var(--radius-lg);
      background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 100%);
      display:flex;align-items:center;justify-content:center;
      color:var(--text-inverse);
      font-family:var(--font-primary);
      font-weight:800;
      font-size:1rem;
      box-shadow: var(--shadow-primary);
      flex-shrink:0;
      cursor:pointer;
      transition: transform var(--transition-base);
    }
    .sidebar-logo-icon:hover { transform: scale(1.05); }

    .sidebar-logo-text{
      overflow:hidden;
      transition: opacity var(--transition-base), max-width var(--transition-base);
      max-width:200px;
    }
    .layout.collapsed .sidebar-logo-text{ opacity:0; max-width:0; }
    .sidebar-logo-text h1{
      font-family:var(--font-primary);
      font-size:1.25rem;
      font-weight:800;
      color:var(--text-primary);
      letter-spacing:-0.5px;
      white-space:nowrap;
    }
    .sidebar-logo-text small{
      display:block;
      font-size:0.6875rem;
      color:var(--text-tertiary);
      margin-top: var(--space-1);
      font-weight:500;
      white-space:nowrap;
    }

    .menu{
      list-style:none;
      padding: 0 var(--space-2);
      flex:1;
      font-size:0.875rem;
    }
    .layout.collapsed .menu { padding: 0 var(--space-1); }
    .menu li { margin-bottom: var(--space-1); }
    .menu a{
      display:flex; align-items:center; gap: var(--space-3);
      padding: var(--space-3) var(--space-3);
      color: var(--text-secondary);
      text-decoration:none;
      border-radius: var(--radius-lg);
      transition: all var(--transition-base);
      white-space:nowrap;
      position:relative;
    }
    .layout.collapsed .menu a{ justify-content:center; padding: var(--space-3); }
    .menu a:hover{
      background: var(--primary-50);
      color: var(--primary-600);
      transform: translateX(4px);
    }
    .layout.collapsed .menu a:hover{ transform: translateX(0) scale(1.05); }
    .menu a.active{
      background: var(--primary-500);
      color: var(--text-inverse);
      box-shadow: var(--shadow-primary);
      font-weight:600;
    }
    .menu-icon{ width:20px; text-align:center; font-size:1.125rem; flex-shrink:0; }
    .menu-text{
      overflow:hidden;
      transition: opacity var(--transition-base), max-width var(--transition-base);
      max-width:200px;
    }
    .layout.collapsed .menu-text{ opacity:0; max-width:0; }
    .menu-tooltip{
      position:absolute; left:100%; top:50%;
      transform: translateY(-50%);
      background: var(--gray-800);
      color:#fff;
      padding: var(--space-2) var(--space-3);
      border-radius: var(--radius-md);
      font-size:0.75rem;
      font-weight:500;
      white-space:nowrap;
      opacity:0; visibility:hidden;
      transition: all var(--transition-fast);
      pointer-events:none;
      z-index:1000;
      box-shadow: var(--shadow-md);
    }
    .layout.collapsed .menu a:hover .menu-tooltip{
      opacity:1; visibility:visible;
      transform: translateY(-50%) translateX(8px);
    }

    .sidebar-footer{
      padding: var(--space-3) var(--space-4);
      font-size:0.6875rem;
      color: var(--text-muted);
      border-top: 1px solid var(--border-light);
      font-weight:500;
      white-space:nowrap;
      overflow:hidden;
      display:flex;
      justify-content:center;
      align-items:center;
      width:100%;
      text-align:center;
    }
    .layout.collapsed .sidebar-footer{
      padding: var(--space-2);
      font-size:0.6rem;
      flex-direction:column;
      justify-content:center;
      align-items:center;
    }
    .sidebar-footer span{ display:inline-block; transition: opacity var(--transition-base); text-align:center; }
    .layout.collapsed .sidebar-footer span:not(:first-child){
      opacity:0; width:0; margin:0;
    }

    /* Main */
    .main-wrapper{ display:flex; flex-direction:column; min-width:0; background:transparent; }
    .topbar{
      background: var(--bg-surface);
      border-bottom: 1px solid var(--border-light);
      padding: var(--space-3) var(--space-6);
      display:flex; align-items:center; justify-content:space-between;
      position:sticky; top:0; z-index:90;
      box-shadow: var(--shadow-sm);
      min-height:60px;
    }
    .topbar-left{ display:flex; align-items:center; flex:1; }
    .topbar-title{
      font-family: var(--font-primary);
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.5px;
      display:flex; align-items:center; gap: var(--space-3);
    }
    .breadcrumb{
      font-size: 0.6875rem;
      color: var(--text-tertiary);
      display:flex; align-items:center; gap: var(--space-2);
      font-weight:500;
    }
    .breadcrumb::before{
      content:'|';
      display:inline-block;
      color: var(--border-medium);
      margin-right: var(--space-2);
      font-weight:400;
    }
    .breadcrumb span{
      background: var(--primary-500);
      color: var(--text-inverse);
      padding: var(--space-1) var(--space-2);
      border-radius: var(--radius-full);
      font-size: 0.625rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .user-info{
      display:flex; align-items:center; gap: var(--space-3);
      font-size:0.8125rem;
      color: var(--text-secondary);
      font-weight:500;
    }
    .user-avatar{
      width:36px;height:36px;border-radius:var(--radius-full);
      background: linear-gradient(135deg, var(--primary-500) 0%, var(--teal) 100%);
      display:flex; align-items:center; justify-content:center;
      color: var(--text-inverse);
      font-weight:700;
      font-size:0.875rem;
      box-shadow: var(--shadow-sm);
      transition: transform var(--transition-base);
      cursor:pointer;
    }
    .user-avatar:hover{ transform: scale(1.05); }

    .content{ padding: var(--space-6); flex:1; }

    /* Page header */
    .page-header{
      display:flex; justify-content:space-between; align-items:center;
      margin-bottom: var(--space-8);
    }
    .page-header h1{
      font-family: var(--font-primary);
      font-size: 1.75rem;
      font-weight: 800;
      color: var(--text-primary);
      letter-spacing: -0.5px;
      display:flex; align-items:center; gap: var(--space-3);
    }
    .page-header h1:before{ content:'üõ°Ô∏è'; font-size:1.5rem; }
    .page-actions{ display:flex; gap: var(--space-3); }

    .btn{
      background: var(--bg-surface);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-md);
      padding: var(--space-2) var(--space-4);
      font-family: var(--font-primary);
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text-secondary);
      cursor:pointer;
      transition: all var(--transition-base);
      display:inline-flex;
      align-items:center;
      gap: var(--space-2);
    }
    .btn:hover{
      background: var(--gray-50);
      border-color: var(--gray-300);
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }
    .btn-primary{
      background: var(--primary-500);
      border-color: transparent;
      color: var(--text-inverse);
      box-shadow: var(--shadow-primary);
    }
    .btn-primary:hover{ background: var(--primary-600); box-shadow: var(--shadow-lg); }
    .btn-success{
      background: var(--success);
      border-color: transparent;
      color: var(--text-inverse);
      box-shadow: 0 4px 14px 0 rgba(16, 185, 129, 0.2);
    }
    .btn-success:hover{ background: #0da271; }
    .btn-danger{
      background: var(--danger);
      border-color: transparent;
      color: var(--text-inverse);
      box-shadow: 0 4px 14px 0 rgba(239, 68, 68, 0.2);
    }
    .btn-danger:hover{ background:#dc2626; }

    /* Layout form + stats */
    .warranty-form-container{
      display:grid;
      grid-template-columns: 1fr 400px;
      gap: var(--space-8);
      margin-bottom: var(--space-8);
      align-items:start;
    }
    @media (max-width: 1024px){
      .warranty-form-container{ grid-template-columns:1fr; }
    }

    .form-panel{
      background: var(--bg-surface);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-xl);
      padding: var(--space-6);
      box-shadow: var(--shadow-md);
      transition: all var(--transition-base);
      height: 100%;
      min-height: 760px;
    }
    .form-panel:hover{ box-shadow: var(--shadow-lg); border-color: var(--primary-300); }

    .form-panel-header{
      margin-bottom: var(--space-6);
      padding-bottom: var(--space-4);
      border-bottom: 1px solid var(--border-light);
    }
    .form-panel-header h2{
      font-family: var(--font-primary);
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
      display:flex; align-items:center; gap: var(--space-3);
    }
    .form-panel-header h2:before{ content:'üìù'; font-size:1rem; }

    .form-group{ margin-bottom: var(--space-6); }
    .form-row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-4);
      margin-bottom: var(--space-4);
    }
    @media (max-width: 768px){
      .form-row{ grid-template-columns:1fr; }
    }

    .form-label{
      display:block;
      margin-bottom: var(--space-2);
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text-secondary);
    }
    .form-label.required:after{ content:' *'; color: var(--danger); }

    .form-input{
      width:100%;
      padding: var(--space-3) var(--space-4);
      font-family: var(--font-secondary);
      font-size: 0.875rem;
      border: 1px solid var(--border-light);
      border-radius: var(--radius-lg);
      background: var(--bg-surface);
      color: var(--text-primary);
      transition: all var(--transition-base);
    }
    .form-input:focus{
      outline:none;
      border-color: var(--primary-400);
      box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
    }
    .form-input:hover:not(:focus){ border-color: var(--border-medium); }
    .form-input::placeholder{ color: var(--text-muted); }

    .form-textarea{ min-height: 110px; resize: vertical; }

    .form-select{
      appearance:none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
      background-repeat:no-repeat;
      background-position: right var(--space-4) center;
      background-size: 1rem;
      padding-right: var(--space-10);
    }

    .hint{
      font-size: 0.75rem;
      color: var(--text-tertiary);
      margin-top: var(--space-2);
      font-weight: 500;
    }

    .form-actions{
      display:flex;
      justify-content:flex-end;
      gap: var(--space-3);
      margin-top: var(--space-8);
      padding-top: var(--space-6);
      border-top: 1px solid var(--border-light);
    }

    /* Stats panel */
    .stats-panel{
      background: var(--bg-surface);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-xl);
      padding: var(--space-6);
      box-shadow: var(--shadow-md);
      height:100%;
      min-height: 760px;
      display:flex;
      flex-direction:column;
    }
    .stats-panel-header{
      margin-bottom: var(--space-6);
      padding-bottom: var(--space-4);
      border-bottom: 1px solid var(--border-light);
    }
    .stats-panel-header h3{
      font-family: var(--font-primary);
      font-size: 1.125rem;
      font-weight:700;
      color: var(--text-primary);
      display:flex;
      align-items:center;
      gap: var(--space-3);
    }
    .stats-panel-header h3:before{ content:'üìä'; font-size:1rem; }

    .stats-main-grid{
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-4);
      margin-bottom: var(--space-6);
    }
    .stat-main-card{
      background: var(--bg-surface);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-lg);
      padding: var(--space-4);
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
      transition: all var(--transition-base);
      box-shadow: var(--shadow-sm);
      height:100%;
    }
    .stat-main-card:hover{
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
      border-color: var(--primary-300);
    }
    .stat-main-icon{
      width:40px;height:40px;border-radius: var(--radius-lg);
      display:flex; align-items:center; justify-content:center;
      font-size: 1.25rem;
      color: var(--text-inverse);
      margin-bottom: var(--space-2);
      box-shadow: var(--shadow-sm);
    }
    .stat-main-value{
      font-family: var(--font-primary);
      font-size: 1.5rem;
      font-weight: 800;
      color: var(--text-primary);
      margin-bottom: var(--space-1);
      line-height:1;
    }
    .stat-main-label{
      font-size: 0.6875rem;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
    }

    .distribution-chart{ margin-bottom: var(--space-6); }
    .distribution-title{
      font-size: 0.75rem;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
      margin-bottom: var(--space-3);
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .distribution-bars{ display:flex; flex-direction:column; gap: var(--space-2); }
    .distribution-bar{ display:flex; align-items:center; gap: var(--space-3); }
    .distribution-bar-label{
      width: 130px;
      font-size: 0.75rem;
      color: var(--text-secondary);
      font-weight: 500;
      white-space: nowrap;
    }
    .distribution-bar-container{
      flex:1;
      height: 24px;
      background: var(--gray-100);
      border-radius: var(--radius-full);
      overflow:hidden;
      position:relative;
    }
    .distribution-bar-fill{
      height:100%;
      border-radius: var(--radius-full);
      transition: width 1s ease-out;
      position:relative;
    }
    .distribution-bar-value{
      position:absolute;
      right: var(--space-2);
      top:50%;
      transform: translateY(-50%);
      font-size: 0.6875rem;
      font-weight: 700;
      color: var(--text-inverse);
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }

    .recent-activities{ flex:1; margin-bottom: var(--space-6); }
    .activities-title{
      font-size:0.75rem;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing:0.5px;
      font-weight:600;
      margin-bottom: var(--space-3);
    }
    .activities-list{
      display:flex;
      flex-direction:column;
      gap: var(--space-3);
      max-height: 180px;
      overflow-y:auto;
      padding-right: var(--space-2);
    }
    .activity-item{
      padding: var(--space-3);
      background: var(--gray-50);
      border-radius: var(--radius-lg);
      border-left: 3px solid var(--primary-400);
    }
    .activity-item:nth-child(2){ border-left-color: var(--success); }
    .activity-item:nth-child(3){ border-left-color: var(--warning); }
    .activity-item:nth-child(4){ border-left-color: var(--purple); }
    .activity-text{
      font-size: 0.75rem;
      color: var(--text-secondary);
      font-weight: 500;
      margin-bottom: var(--space-1);
    }
    .activity-time{
      font-size: 0.625rem;
      color: var(--text-muted);
      font-weight: 500;
    }

    .quick-tips{
      margin-top:auto;
      padding-top: var(--space-6);
      border-top: 1px solid var(--border-light);
    }
    .tips-title{
      font-size:0.75rem;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing:0.5px;
      font-weight:600;
      margin-bottom: var(--space-3);
    }
    .tips-list{ font-size:0.75rem; color: var(--text-secondary); }
    .tip-item{ display:flex; align-items:flex-start; gap: var(--space-2); margin-bottom: var(--space-2); }
    .tip-item:before{ content:'üí°'; font-size:0.875rem; flex-shrink:0; }

    /* Table */
    .models-panel{
      background: var(--bg-surface);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-xl);
      padding: var(--space-6);
      box-shadow: var(--shadow-md);
      margin-top: var(--space-8);
    }
    .models-panel-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom: var(--space-6);
    }
    .models-panel-header h2{
      font-family: var(--font-primary);
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
      display:flex;
      align-items:center;
      gap: var(--space-3);
    }
    .models-panel-header h2:before{ content:'üõ°Ô∏è'; font-size:1rem; }

    .search-container{ display:flex; gap: var(--space-2); }
    .search-input{
      width: 280px;
      padding: var(--space-2) var(--space-4);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-lg);
      font-family: var(--font-secondary);
      font-size: 0.875rem;
      transition: all var(--transition-base);
    }
    .search-input:focus{
      outline:none;
      border-color: var(--primary-400);
      box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
    }

    .models-table{
      width:100%;
      border-collapse: separate;
      border-spacing: 0;
      font-size: 0.875rem;
      border-radius: var(--radius-lg);
      overflow:hidden;
      box-shadow: var(--shadow-sm);
    }
    .models-table th,
    .models-table td{
      padding: var(--space-3) var(--space-4);
      text-align:left;
      border-bottom: 1px solid var(--border-light);
      vertical-align: top;
    }
    .models-table th{
      background: var(--gray-50);
      color: var(--text-secondary);
      font-family: var(--font-primary);
      font-weight: 600;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 2px solid var(--border-light);
    }
    .models-table tr:last-child td{ border-bottom:none; }
    .models-table tr:hover td{ background: var(--primary-50); }

    .model-status{
      display:inline-block;
      padding: var(--space-1) var(--space-3);
      border-radius: var(--radius-full);
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .status-active{ background: var(--success-light); color: var(--success); }
    .status-inactive{ background: var(--danger-light); color: var(--danger); }

    .device-pill{
      display:inline-flex;
      align-items:center;
      gap: var(--space-2);
      padding: var(--space-1) var(--space-3);
      border-radius: var(--radius-full);
      font-size: 0.75rem;
      font-weight: 600;
      background: var(--primary-50);
      color: var(--primary-700);
      border: 1px solid rgba(14,165,233,0.15);
      white-space: nowrap;
    }

    .table-actions{ display:flex; gap: var(--space-2); }
    .btn-icon{
      width: 32px;
      height: 32px;
      padding: 0;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      border-radius: var(--radius-md);
    }
    .btn-edit{
      background: var(--warning-light);
      border-color: transparent;
      color: var(--warning);
    }
    .btn-edit:hover{ background:#fbbf24; color:white; }
    .btn-delete{
      background: var(--danger-light);
      border-color: transparent;
      color: var(--danger);
    }
    .btn-delete:hover{ background: var(--danger); color:white; }
    .btn-view{
      background: var(--info-light);
      border-color: transparent;
      color: var(--info);
    }
    .btn-view:hover{ background: var(--info); color:white; }

    .empty-state{
      text-align:center;
      padding: var(--space-12) var(--space-6);
      color: var(--text-tertiary);
    }
    .empty-state-icon{
      font-size: 3rem;
      margin-bottom: var(--space-4);
      opacity: 0.5;
    }

    /* Modal */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background: rgba(17, 24, 39, 0.75);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:1000;
      animation: fadeIn 0.3s ease-out;
    }
    @keyframes fadeIn{ from{opacity:0;} to{opacity:1;} }

    .modal{
      background: var(--bg-surface);
      border-radius: var(--radius-xl);
      padding: var(--space-6);
      width: 560px;
      max-width: 90vw;
      box-shadow: var(--shadow-2xl);
      border: 1px solid var(--border-light);
      animation: slideUp 0.3s ease-out;
    }
    @keyframes slideUp{
      from{ transform: translateY(20px); opacity:0; }
      to{ transform: translateY(0); opacity:1; }
    }
    .modal-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom: var(--space-4);
    }
    .modal-header h3{
      font-family: var(--font-primary);
      font-size: 1.125rem;
      font-weight: 700;
      color: var(--text-primary);
    }
    .modal-close{
      background: var(--bg-surface);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-full);
      width: 32px;
      height: 32px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 1.25rem;
      color: var(--text-secondary);
      cursor:pointer;
      transition: all var(--transition-base);
    }
    .modal-close:hover{
      background: var(--danger-light);
      border-color: var(--danger);
      color: var(--danger);
    }
    .modal-body{
      max-height: 420px;
      overflow-y: auto;
      padding-right: var(--space-2);
    }

    /* Responsividade */
    @media (max-width: 768px){
      .layout { grid-template-columns: 1fr; }

      .sidebar-wrapper{
        position:fixed;
        bottom:0;
        top:auto;
        height:auto;
        width:100%;
        border-right:none;
        border-top:1px solid var(--border-light);
        z-index:1000;
      }
      .sidebar{ padding: var(--space-4) 0; flex-direction:row; align-items:center; }
      .menu{ display:flex; overflow-x:auto; flex: 0 0 auto; }
      .menu li{ margin:0; }
      .menu a{ flex-direction:column; padding: var(--space-2); }
      .menu-text{ font-size: 0.625rem; }

      .content{ padding: var(--space-4); }
      .topbar{ padding: var(--space-4); }

      .page-header{
        flex-direction:column;
        gap: var(--space-4);
        align-items:flex-start;
      }
      .page-actions{
        width:100%;
        justify-content:space-between;
      }
      .models-panel-header{
        flex-direction:column;
        gap: var(--space-4);
        align-items:flex-start;
      }
      .search-container{ width:100%; }
      .search-input{ flex:1; width:auto; }

      .stats-main-grid{ grid-template-columns:1fr; }
    }

    .fade-in{ animation: fadeIn 0.5s ease-out; }
    .slide-in{ animation: slideUp 0.5s ease-out; }
  </style>
</head>
<body>
  <div class="layout" id="mainLayout">
    <!-- SIDEBAR -->
    <div class="sidebar-wrapper">
      <aside class="sidebar">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon" onclick="toggleSidebar()">OS</div>
          <div class="sidebar-logo-text">
            <h1>OS Flow</h1>
            <small>Dashboard Inteligente</small>
          </div>
        </div>

        <ul class="menu">
          <li><a href="index.html">
            <span class="menu-icon">üìä</span>
            <span class="menu-text">Dashboard</span>
            <span class="menu-tooltip">Dashboard</span>
          </a></li>
          <li><a href="cadastrar-clientes.html">
            <span class="menu-icon">üë•</span>
            <span class="menu-text">Clientes</span>
            <span class="menu-tooltip">Clientes</span>
          </a></li>
          <li><a href="produtos.html">
            <span class="menu-icon">üì¶</span>
            <span class="menu-text">Produtos</span>
            <span class="menu-tooltip">Produtos</span>
          </a></li>
          <li><a href="servicos.html">
            <span class="menu-icon">üîß</span>
            <span class="menu-text">Servi√ßos</span>
            <span class="menu-tooltip">Servi√ßos</span>
          </a></li>
          <li><a href="vendas.html">
            <span class="menu-icon">üí∞</span>
            <span class="menu-text">Vendas</span>
            <span class="menu-tooltip">Vendas</span>
          </a></li>
          <li><a href="ordem-servico.html">
            <span class="menu-icon">üìã</span>
            <span class="menu-text">Ordens</span>
            <span class="menu-tooltip">Ordens</span>
          </a></li>
          <li><a href="garantias.html" class="active">
            <span class="menu-icon">üõ°Ô∏è</span>
            <span class="menu-text">Garantias</span>
            <span class="menu-tooltip">Garantias</span>
          </a></li>
          <li><a href="#">
            <span class="menu-icon">üìÅ</span>
            <span class="menu-text">Arquivos</span>
            <span class="menu-tooltip">Arquivos</span>
          </a></li>
          <li><a href="#">
            <span class="menu-icon">üí≥</span>
            <span class="menu-text">Financeiro</span>
            <span class="menu-tooltip">Financeiro</span>
          </a></li>
          <li><a href="#">
            <span class="menu-icon">üìÑ</span>
            <span class="menu-text">Cobran√ßa</span>
            <span class="menu-tooltip">Cobran√ßa</span>
          </a></li>
          <li><a href="#">
            <span class="menu-icon">‚öôÔ∏è</span>
            <span class="menu-text">Configura√ß√µes</span>
            <span class="menu-tooltip">Configura√ß√µes</span>
          </a></li>
        </ul>

        <div class="sidebar-footer">
          v3.8.1 ‚Ä¢ ¬© <span id="ano-atual"></span> ‚Ä¢ OS Flow
        </div>
      </aside>
    </div>

    <!-- MAIN -->
    <div class="main-wrapper">
      <header class="topbar">
        <div class="topbar-left">
          <div class="topbar-title">
            Modelos de Garantia
            <div class="breadcrumb">
              <span>Pol√≠ticas & Regras</span>
            </div>
          </div>
        </div>
        <div class="user-info">
          <span>Bem-vindo, <strong>V1ctor Gomes</strong></span>
          <div class="user-avatar">VG</div>
        </div>
      </header>

      <main class="content fade-in">
        <!-- HEADER -->
        <div class="page-header slide-in">
          <h1>Cadastro de Garantias</h1>
          <div class="page-actions">
            <button class="btn" onclick="exportarGarantias()">
              <span>üì§</span> Exportar
            </button>
            <button class="btn btn-primary" onclick="limparFormulario()">
              <span>üÜï</span> Nova Garantia
            </button>
          </div>
        </div>

        <!-- FORM + STATS -->
        <div class="warranty-form-container">
          <!-- FORM -->
          <section class="form-panel slide-in">
            <div class="form-panel-header">
              <h2>Dados do Modelo</h2>
            </div>

            <form id="garantiaForm" onsubmit="salvarGarantia(event)">
              <div class="form-row">
                <div class="form-group">
                  <label class="form-label required" for="nome">Nome do Modelo</label>
                  <input type="text" id="nome" class="form-input" placeholder="Ex: Garantia Padr√£o 90 dias" required>
                  <div class="hint">Dica: use um nome que fa√ßa sentido para equipe e cliente.</div>
                </div>

                <div class="form-group">
                  <label class="form-label required" for="dispositivo">Tipo de Dispositivo</label>
                  <select id="dispositivo" class="form-input form-select" required>
                    <option value="">Selecione...</option>
                    <option value="celular">üì± Celular</option>
                    <option value="tablet">üì≤ Tablet</option>
                    <option value="notebook">üíª Notebook</option>
                    <option value="pc">üñ•Ô∏è Computador</option>
                    <option value="tv">üì∫ TV</option>
                    <option value="videogame">üéÆ Videogame</option>
                    <option value="som">üîä Som/√Åudio</option>
                    <option value="outros">üß© Outros</option>
                  </select>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label class="form-label required" for="prazoDias">Prazo (em dias)</label>
                  <input type="number" id="prazoDias" class="form-input" placeholder="Ex: 90" min="0" required>
                </div>

                <div class="form-group">
                  <label class="form-label required" for="status">Status</label>
                  <select id="status" class="form-input form-select" required>
                    <option value="ativo">Ativo</option>
                    <option value="inativo">Inativo</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label class="form-label required" for="cobertura">Cobertura (o que est√° incluso)</label>
                <textarea id="cobertura" class="form-input form-textarea" placeholder="Descreva a cobertura da garantia..." required></textarea>
              </div>

              <div class="form-group">
                <label class="form-label" for="exclusoes">Exclus√µes (o que n√£o cobre)</label>
                <textarea id="exclusoes" class="form-input form-textarea" placeholder="Ex: mau uso, oxida√ß√£o, tela trincada..."></textarea>
              </div>

              <div class="form-group">
                <label class="form-label" for="condicoes">Condi√ß√µes / Procedimento</label>
                <textarea id="condicoes" class="form-input form-textarea" placeholder="Ex: apresentar NF/OS, lacres intactos, prazo de an√°lise..."></textarea>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-danger" onclick="limparFormulario()">
                  <span>üóëÔ∏è</span> Limpar
                </button>
                <button type="submit" class="btn btn-success">
                  <span>üíæ</span> Salvar Garantia
                </button>
              </div>
            </form>
          </section>

          <!-- STATS -->
          <aside class="stats-panel slide-in">
            <div class="stats-panel-header">
              <h3>Estat√≠sticas das Garantias</h3>
            </div>

            <div class="stats-main-grid">
              <div class="stat-main-card">
                <div class="stat-main-icon" style="background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 100%);">üõ°Ô∏è</div>
                <div class="stat-main-value" id="totalGarantias">0</div>
                <div class="stat-main-label">Modelos</div>
              </div>

              <div class="stat-main-card">
                <div class="stat-main-icon" style="background: linear-gradient(135deg, var(--success) 0%, #34d399 100%);">‚úÖ</div>
                <div class="stat-main-value" id="garantiasAtivas">0</div>
                <div class="stat-main-label">Ativas</div>
              </div>

              <div class="stat-main-card">
                <div class="stat-main-icon" style="background: linear-gradient(135deg, var(--warning) 0%, #fbbf24 100%);">‚è±Ô∏è</div>
                <div class="stat-main-value" id="prazoMedio">0</div>
                <div class="stat-main-label">Prazo M√©dio (dias)</div>
              </div>

              <div class="stat-main-card">
                <div class="stat-main-icon" style="background: linear-gradient(135deg, var(--purple) 0%, #a78bfa 100%);">üè∑Ô∏è</div>
                <div class="stat-main-value" id="tipoMaisComum">-</div>
                <div class="stat-main-label">Tipo + comum</div>
              </div>
            </div>

            <div class="distribution-chart">
              <div class="distribution-title">
                <span>Distribui√ß√£o por Status</span>
                <span id="percentAtivas">0%</span>
              </div>

              <div class="distribution-bars">
                <div class="distribution-bar">
                  <span class="distribution-bar-label">Ativas</span>
                  <div class="distribution-bar-container">
                    <div class="distribution-bar-fill" id="barAtivas" style="background: linear-gradient(90deg, var(--success) 0%, #34d399 100%); width: 0%;">
                      <span class="distribution-bar-value" id="valAtivas">0</span>
                    </div>
                  </div>
                </div>

                <div class="distribution-bar">
                  <span class="distribution-bar-label">Inativas</span>
                  <div class="distribution-bar-container">
                    <div class="distribution-bar-fill" id="barInativas" style="background: linear-gradient(90deg, var(--danger) 0%, #f87171 100%); width: 0%;">
                      <span class="distribution-bar-value" id="valInativas">0</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="recent-activities">
              <div class="activities-title">Atividades Recentes</div>
              <div class="activities-list" id="atividadesLista"></div>
            </div>

            <div class="quick-tips">
              <div class="tips-title">Dicas R√°pidas</div>
              <div class="tips-list">
                <div class="tip-item">Crie modelos separados por dispositivo e por tipo de servi√ßo (tela/bateria/placa).</div>
                <div class="tip-item">Padronize exclus√µes para reduzir conflitos com cliente.</div>
                <div class="tip-item">Use ‚ÄúInativo‚Äù para pol√≠ticas antigas sem apagar hist√≥rico.</div>
              </div>
            </div>
          </aside>
        </div>

        <!-- TABLE -->
        <section class="models-panel slide-in">
          <div class="models-panel-header">
            <h2>Modelos Cadastrados</h2>
            <div class="search-container">
              <input type="text" class="search-input" placeholder="Buscar por nome, tipo, prazo..." id="buscarGarantia" onkeyup="filtrarGarantias()">
              <button class="btn" onclick="filtrarGarantias()">
                <span>üîç</span> Buscar
              </button>
            </div>
          </div>

          <div class="table-container">
            <table class="models-table" id="tabelaGarantias">
              <thead>
                <tr>
                  <th>Modelo</th>
                  <th>Dispositivo</th>
                  <th>Prazo</th>
                  <th>Status</th>
                  <th>Resumo</th>
                  <th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="garantiasLista"></tbody>
            </table>
          </div>

          <div id="semGarantias" class="empty-state" style="display: none;">
            <div class="empty-state-icon">üõ°Ô∏è</div>
            <h3>Nenhuma garantia cadastrada</h3>
            <p>Cadastre seu primeiro modelo de garantia usando o formul√°rio acima.</p>
          </div>
        </section>
      </main>
    </div>
  </div>

  <!-- MODAL CONFIRMA√á√ÉO -->
  <div class="modal-backdrop" id="modalConfirmacao">
    <div class="modal">
      <div class="modal-header">
        <h3 id="modalTitulo">Confirma√ß√£o</h3>
        <button class="modal-close" onclick="fecharModal()">√ó</button>
      </div>
      <div class="modal-body" id="modalCorpo"></div>
      <div style="display:flex; justify-content:flex-end; gap: var(--space-3); margin-top: var(--space-6);">
        <button class="btn" onclick="fecharModal()">Cancelar</button>
        <button class="btn btn-danger" id="btnConfirmarAcao" onclick="confirmarAcao()">Confirmar</button>
      </div>
    </div>
  </div>

  <!-- MODAL DETALHES -->
  <div class="modal-backdrop" id="modalDetalhes">
    <div class="modal">
      <div class="modal-header">
        <h3 id="modalDetalhesTitulo">Detalhes do Modelo</h3>
        <button class="modal-close" onclick="fecharModalDetalhes()">√ó</button>
      </div>
      <div class="modal-body" id="modalDetalhesCorpo"></div>
      <div style="display:flex; justify-content:center; gap: var(--space-3); margin-top: var(--space-6);">
        <button class="btn btn-primary" onclick="fecharModalDetalhes()">
          <span>‚úÖ</span> OK
        </button>
      </div>
    </div>
  </div>

  <script>
    // ============================
    // LOCALSTORAGE PADRONIZADO (OS Flow)
    // ============================
    const LS = Object.freeze({
      garantias: 'osflow:garantias',
      atividadesGarantias: 'osflow:atividades:garantias',
      sidebarCollapsed: 'osflow:ui:sidebarCollapsed',

      // legado (migra√ß√£o)
      legacyGarantias: 'garantiasOSFlow',
      legacyAtividadesGarantias: 'atividadesGarantias',
      legacySidebarCollapsed: 'sidebarCollapsed'
    });

    function migrateLocalStorageKeys() {
      if (!localStorage.getItem(LS.garantias) && localStorage.getItem(LS.legacyGarantias)) {
        localStorage.setItem(LS.garantias, localStorage.getItem(LS.legacyGarantias));
      }
      if (!localStorage.getItem(LS.atividadesGarantias) && localStorage.getItem(LS.legacyAtividadesGarantias)) {
        localStorage.setItem(LS.atividadesGarantias, localStorage.getItem(LS.legacyAtividadesGarantias));
      }
      if (!localStorage.getItem(LS.sidebarCollapsed) && localStorage.getItem(LS.legacySidebarCollapsed)) {
        localStorage.setItem(LS.sidebarCollapsed, localStorage.getItem(LS.legacySidebarCollapsed));
      }
    }

    function lsReadJSON(key, fallback) {
      try {
        const raw = localStorage.getItem(key);
        if (!raw) return fallback;
        return JSON.parse(raw);
      } catch {
        return fallback;
      }
    }

    function lsWriteJSON(key, value) {
      localStorage.setItem(key, JSON.stringify(value));
    }

    migrateLocalStorageKeys();

    // ============================
    // Dados (garantias)
    // ============================
    const garantiasDefault = [
      {
        id: 1,
        nome: 'Garantia Padr√£o - Celular (90 dias)',
        dispositivo: 'celular',
        prazoDias: 90,
        cobertura: 'Cobertura para defeitos de servi√ßo e pe√ßas substitu√≠das, mediante uso adequado.',
        exclusoes: 'N√£o cobre mau uso, oxida√ß√£o, quedas, trincas e danos est√©ticos.',
        condicoes: 'Necess√°rio apresentar OS. Lacres intactos quando aplic√°vel.',
        status: 'ativo',
        dataCadastro: '2024-02-10'
      },
      {
        id: 2,
        nome: 'Garantia TV - Placa / Fonte (180 dias)',
        dispositivo: 'tv',
        prazoDias: 180,
        cobertura: 'Cobertura para reparo de placa/fonte substitu√≠da e m√£o de obra.',
        exclusoes: 'N√£o cobre descargas el√©tricas, infiltra√ß√£o, oxida√ß√£o e mau uso.',
        condicoes: 'An√°lise t√©cnica obrigat√≥ria. Garantia v√°lida somente para o componente reparado.',
        status: 'ativo',
        dataCadastro: '2024-02-15'
      },
      {
        id: 3,
        nome: 'Garantia B√°sica - Notebook (30 dias)',
        dispositivo: 'notebook',
        prazoDias: 30,
        cobertura: 'Cobertura de m√£o de obra do servi√ßo executado.',
        exclusoes: 'N√£o cobre novo problema n√£o relacionado ao servi√ßo anterior.',
        condicoes: 'Prazo contado a partir da data de entrega.',
        status: 'inativo',
        dataCadastro: '2024-01-22'
      }
    ];

    let garantias = lsReadJSON(LS.garantias, null);
    if (!Array.isArray(garantias) || garantias.length === 0) {
      garantias = garantiasDefault;
      lsWriteJSON(LS.garantias, garantias);
    }

    let garantiaEditando = null;
    let acaoConfirmar = null;
    let dadosConfirmacao = null;

    // ============================
    // Init
    // ============================
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('ano-atual').textContent = new Date().getFullYear();

      restoreSidebarState();

      carregarGarantias();
      atualizarEstatisticas();
      carregarAtividades();
    });

    function toggleSidebar() {
      const layout = document.getElementById('mainLayout');
      layout.classList.toggle('collapsed');
      localStorage.setItem(LS.sidebarCollapsed, layout.classList.contains('collapsed'));
    }

    function restoreSidebarState() {
      const isCollapsed = localStorage.getItem(LS.sidebarCollapsed) === 'true';
      const layout = document.getElementById('mainLayout');
      if (isCollapsed) layout.classList.add('collapsed');
    }

    // ============================
    // Helpers
    // ============================
    function deviceLabel(value) {
      const map = {
        celular: 'üì± Celular',
        tablet: 'üì≤ Tablet',
        notebook: 'üíª Notebook',
        pc: 'üñ•Ô∏è Computador',
        tv: 'üì∫ TV',
        videogame: 'üéÆ Videogame',
        som: 'üîä Som/√Åudio',
        outros: 'üß© Outros'
      };
      return map[value] || value;
    }

    function escapeHTML(s) {
      return String(s ?? '')
        .replaceAll('&', '&amp;')
        .replaceAll('<', '&lt;')
        .replaceAll('>', '&gt;')
        .replaceAll('"', '&quot;')
        .replaceAll("'", '&#039;');
    }

    function formatDateBR(dateStr) {
      const d = new Date(dateStr);
      if (Number.isNaN(d.getTime())) return '-';
      return d.toLocaleDateString('pt-BR');
    }

    // ============================
    // Atividades (LS padronizado)
    // ============================
    function obterAtividades() {
      return lsReadJSON(LS.atividadesGarantias, null) || [
        { texto: 'Modelo "Garantia Padr√£o - Celular (90 dias)" atualizado', tempo: 'h√° 2 dias', tipo: 'edicao' },
        { texto: 'Novo modelo "Garantia TV - Placa / Fonte" cadastrado', tempo: 'h√° 1 semana', tipo: 'cadastro' },
        { texto: 'Modelo "Garantia B√°sica - Notebook" marcado como inativo', tempo: 'h√° 2 semanas', tipo: 'status' },
        { texto: 'Exporta√ß√£o de modelos conclu√≠da', tempo: 'h√° 1 m√™s', tipo: 'exportacao' }
      ];
    }

    function registrarAtividade(texto, tipo) {
      const atividades = obterAtividades();
      atividades.unshift({ texto, tempo: 'agora mesmo', tipo });
      if (atividades.length > 4) atividades.pop();
      lsWriteJSON(LS.atividadesGarantias, atividades);
    }

    function carregarAtividades() {
      const el = document.getElementById('atividadesLista');
      const atividades = obterAtividades();
      el.innerHTML = atividades.map(a => `
        <div class="activity-item">
          <div class="activity-text">${escapeHTML(a.texto)}</div>
          <div class="activity-time">${escapeHTML(a.tempo)}</div>
        </div>
      `).join('');
    }

    // ============================
    // CRUD
    // ============================
    function salvarGarantia(event) {
      event.preventDefault();

      const garantia = {
        id: garantiaEditando ? garantiaEditando.id : Date.now(),
        nome: document.getElementById('nome').value.trim(),
        dispositivo: document.getElementById('dispositivo').value,
        prazoDias: parseInt(document.getElementById('prazoDias').value, 10) || 0,
        cobertura: document.getElementById('cobertura').value.trim(),
        exclusoes: document.getElementById('exclusoes').value.trim(),
        condicoes: document.getElementById('condicoes').value.trim(),
        status: document.getElementById('status').value,
        dataCadastro: garantiaEditando ? garantiaEditando.dataCadastro : new Date().toISOString().split('T')[0]
      };

      if (garantiaEditando) {
        const index = garantias.findIndex(g => g.id === garantiaEditando.id);
        if (index >= 0) garantias[index] = garantia;

        registrarAtividade(`Modelo "${garantia.nome}" atualizado`, 'edicao');
        mostrarNotificacao('‚úÖ Modelo de garantia atualizado!', 'success');
      } else {
        garantias.push(garantia);

        registrarAtividade(`Novo modelo criado: ${garantia.nome}`, 'cadastro');
        mostrarNotificacao('‚ú® Modelo de garantia cadastrado!', 'success');
      }

      lsWriteJSON(LS.garantias, garantias);

      carregarGarantias();
      atualizarEstatisticas();
      carregarAtividades();
      limparFormulario();

      garantiaEditando = null;
    }

    function carregarGarantias() {
      garantias = lsReadJSON(LS.garantias, garantias) || [];

      const tbody = document.getElementById('garantiasLista');
      const emptyState = document.getElementById('semGarantias');

      if (garantias.length === 0) {
        tbody.innerHTML = '';
        emptyState.style.display = 'block';
        return;
      }
      emptyState.style.display = 'none';

      const ordenadas = [...garantias].sort((a, b) => (a.nome || '').localeCompare(b.nome || ''));

      tbody.innerHTML = ordenadas.map(g => {
        const cobertura = g.cobertura || '';
        const resumo = cobertura.slice(0, 80) + (cobertura.length > 80 ? '‚Ä¶' : '');

        return `
          <tr data-id="${g.id}">
            <td><strong>${escapeHTML(g.nome)}</strong></td>
            <td><span class="device-pill">${escapeHTML(deviceLabel(g.dispositivo))}</span></td>
            <td><strong>${g.prazoDias}</strong> dias</td>
            <td>
              <span class="model-status ${g.status === 'ativo' ? 'status-active' : 'status-inactive'}">
                ${g.status === 'ativo' ? 'Ativo' : 'Inativo'}
              </span>
            </td>
            <td style="color: var(--text-tertiary); font-size: 0.8125rem;">
              ${escapeHTML(resumo)}
            </td>
            <td>
              <div class="table-actions">
                <button class="btn btn-icon btn-view" title="Ver detalhes" onclick="verDetalhes(${g.id})"><span>üëÅÔ∏è</span></button>
                <button class="btn btn-icon btn-edit" title="Editar" onclick="editarGarantia(${g.id})"><span>‚úèÔ∏è</span></button>
                <button class="btn btn-icon btn-delete" title="Excluir" onclick="confirmarExclusao(${g.id})"><span>üóëÔ∏è</span></button>
              </div>
            </td>
          </tr>
        `;
      }).join('');
    }

    function editarGarantia(id) {
      garantiaEditando = garantias.find(g => g.id === id);
      if (!garantiaEditando) return;

      document.getElementById('nome').value = garantiaEditando.nome || '';
      document.getElementById('dispositivo').value = garantiaEditando.dispositivo || '';
      document.getElementById('prazoDias').value = garantiaEditando.prazoDias ?? 0;
      document.getElementById('cobertura').value = garantiaEditando.cobertura || '';
      document.getElementById('exclusoes').value = garantiaEditando.exclusoes || '';
      document.getElementById('condicoes').value = garantiaEditando.condicoes || '';
      document.getElementById('status').value = garantiaEditando.status || 'ativo';

      document.querySelector('.form-panel').scrollIntoView({ behavior: 'smooth' });
      mostrarNotificacao('üìù Editando: ' + garantiaEditando.nome, 'info');
    }

    function limparFormulario() {
      document.getElementById('garantiaForm').reset();
      garantiaEditando = null;
      mostrarNotificacao('üÜï Formul√°rio limpo. Pronto para novo cadastro.', 'info');
    }

    function verDetalhes(id) {
      const g = garantias.find(x => x.id === id);
      if (!g) return;

      document.getElementById('modalDetalhesTitulo').textContent = `Detalhes: ${g.nome || ''}`;

      document.getElementById('modalDetalhesCorpo').innerHTML = `
        <div style="display:grid; gap: var(--space-4);">
          <div style="display:grid; grid-template-columns: 1fr 1fr; gap: var(--space-4);">
            <div>
              <div style="font-size:0.75rem;color:var(--text-tertiary);margin-bottom:var(--space-1);">Dispositivo</div>
              <div style="font-weight:700;">${escapeHTML(deviceLabel(g.dispositivo))}</div>
            </div>
            <div>
              <div style="font-size:0.75rem;color:var(--text-tertiary);margin-bottom:var(--space-1);">Prazo</div>
              <div style="font-weight:700;">${g.prazoDias} dias</div>
            </div>
          </div>

          <div style="display:grid; grid-template-columns: 1fr 1fr; gap: var(--space-4);">
            <div>
              <div style="font-size:0.75rem;color:var(--text-tertiary);margin-bottom:var(--space-1);">Status</div>
              <div style="font-weight:700; color: ${g.status === 'ativo' ? 'var(--success)' : 'var(--danger)'};">
                ${g.status === 'ativo' ? 'Ativo' : 'Inativo'}
              </div>
            </div>
            <div>
              <div style="font-size:0.75rem;color:var(--text-tertiary);margin-bottom:var(--space-1);">Cadastrado em</div>
              <div style="font-weight:700;">${escapeHTML(formatDateBR(g.dataCadastro))}</div>
            </div>
          </div>

          <div style="border-top: 1px solid var(--border-light); padding-top: var(--space-4);">
            <div style="font-size:0.75rem;color:var(--text-tertiary);margin-bottom:var(--space-2);">Cobertura</div>
            <div style="background: var(--gray-50); border: 1px solid var(--border-light); padding: var(--space-3); border-radius: var(--radius-lg); color: var(--text-secondary);">
              ${escapeHTML(g.cobertura || '-')}
            </div>
          </div>

          <div>
            <div style="font-size:0.75rem;color:var(--text-tertiary);margin-bottom:var(--space-2);">Exclus√µes</div>
            <div style="background: var(--gray-50); border: 1px solid var(--border-light); padding: var(--space-3); border-radius: var(--radius-lg); color: var(--text-secondary);">
              ${escapeHTML(g.exclusoes || '-')}
            </div>
          </div>

          <div>
            <div style="font-size:0.75rem;color:var(--text-tertiary);margin-bottom:var(--space-2);">Condi√ß√µes / Procedimento</div>
            <div style="background: var(--gray-50); border: 1px solid var(--border-light); padding: var(--space-3); border-radius: var(--radius-lg); color: var(--text-secondary);">
              ${escapeHTML(g.condicoes || '-')}
            </div>
          </div>
        </div>
      `;

      abrirModalDetalhes();
    }

    function confirmarExclusao(id) {
      const g = garantias.find(x => x.id === id);
      if (!g) return;

      acaoConfirmar = 'excluirGarantia';
      dadosConfirmacao = { id, nome: g.nome };

      document.getElementById('modalTitulo').textContent = 'Confirmar Exclus√£o';
      document.getElementById('modalCorpo').innerHTML = `
        <p>Tem certeza que deseja excluir o modelo <strong>${escapeHTML(g.nome)}</strong>?</p>
        <p style="color: var(--danger); font-size: 0.875rem; margin-top: var(--space-2);">
          ‚ö†Ô∏è Esta a√ß√£o n√£o pode ser desfeita.
        </p>
      `;
      abrirModal();
    }

    function excluirGarantia(id) {
      const g = garantias.find(x => x.id === id);
      garantias = garantias.filter(x => x.id !== id);

      lsWriteJSON(LS.garantias, garantias);

      registrarAtividade(`Modelo "${g ? g.nome : 'removido'}" exclu√≠do`, 'exclusao');

      carregarGarantias();
      atualizarEstatisticas();
      carregarAtividades();

      mostrarNotificacao('üóëÔ∏è Modelo exclu√≠do com sucesso!', 'warning');
    }

    // ============================
    // Filtro
    // ============================
    function filtrarGarantias() {
      const termo = document.getElementById('buscarGarantia').value.toLowerCase();
      const linhas = document.querySelectorAll('#garantiasLista tr');
      let encontrados = 0;

      linhas.forEach(linha => {
        const texto = linha.textContent.toLowerCase();
        const ok = texto.includes(termo);
        linha.style.display = ok ? '' : 'none';
        if (ok) encontrados++;
      });

      const emptyState = document.getElementById('semGarantias');
      if (encontrados === 0 && termo !== '') {
        emptyState.innerHTML = `
          <div class="empty-state-icon">üîç</div>
          <h3>Nenhum modelo encontrado</h3>
          <p>Nenhuma garantia corresponde √† busca: "${escapeHTML(termo)}"</p>
        `;
        emptyState.style.display = 'block';
      } else {
        emptyState.style.display = 'none';
      }
    }

    // ============================
    // Estat√≠sticas (dados reais)
    // ============================
    function atualizarEstatisticas() {
      garantias = lsReadJSON(LS.garantias, garantias) || [];

      const total = garantias.length;
      const ativas = garantias.filter(g => g.status === 'ativo').length;
      const inativas = garantias.filter(g => g.status === 'inativo').length;

      const prazoMedio = total > 0
        ? Math.round(garantias.reduce((acc, g) => acc + (Number(g.prazoDias) || 0), 0) / total)
        : 0;

      // Tipo mais comum
      const countTipo = {};
      garantias.forEach(g => {
        if (!g.dispositivo) return;
        countTipo[g.dispositivo] = (countTipo[g.dispositivo] || 0) + 1;
      });
      const tipoMais = Object.entries(countTipo).sort((a,b) => b[1] - a[1])[0];
      const tipoMaisComum = tipoMais ? deviceLabel(tipoMais[0]) : '-';

      const percentAtivas = total > 0 ? Math.round((ativas / total) * 100) : 0;
      const percentInativas = total > 0 ? Math.round((inativas / total) * 100) : 0;

      document.getElementById('totalGarantias').textContent = String(total);
      document.getElementById('garantiasAtivas').textContent = String(ativas);
      document.getElementById('prazoMedio').textContent = String(prazoMedio);
      document.getElementById('tipoMaisComum').textContent = tipoMaisComum;

      document.getElementById('percentAtivas').textContent = percentAtivas + '%';
      document.getElementById('valAtivas').textContent = String(ativas);
      document.getElementById('valInativas').textContent = String(inativas);

      setTimeout(() => {
        document.getElementById('barAtivas').style.width = percentAtivas + '%';
        document.getElementById('barInativas').style.width = percentInativas + '%';
      }, 80);
    }

    // ============================
    // Exportar (simples)
    // ============================
    function exportarGarantias() {
      if (!garantias || garantias.length === 0) {
        mostrarNotificacao('‚ÑπÔ∏è Nenhum modelo para exportar.', 'info');
        return;
      }

      registrarAtividade('Exporta√ß√£o de modelos conclu√≠da', 'exportacao');
      carregarAtividades();

      mostrarNotificacao('üì§ Exportando modelos...', 'info');
      setTimeout(() => { mostrarNotificacao('‚úÖ Exportado com sucesso!', 'success'); }, 1200);
    }

    // ============================
    // Modal
    // ============================
    function abrirModal() { document.getElementById('modalConfirmacao').style.display = 'flex'; }

    function fecharModal() {
      const modal = document.getElementById('modalConfirmacao');
      modal.style.animation = 'fadeOut 0.3s ease-out forwards';
      setTimeout(() => { modal.style.display = 'none'; modal.style.animation = ''; }, 300);
    }

    function confirmarAcao() {
      if (acaoConfirmar === 'excluirGarantia') excluirGarantia(dadosConfirmacao.id);
      fecharModal();
      acaoConfirmar = null;
      dadosConfirmacao = null;
    }

    function abrirModalDetalhes() { document.getElementById('modalDetalhes').style.display = 'flex'; }

    function fecharModalDetalhes() {
      const modal = document.getElementById('modalDetalhes');
      modal.style.animation = 'fadeOut 0.3s ease-out forwards';
      setTimeout(() => { modal.style.display = 'none'; modal.style.animation = ''; }, 300);
    }

    // ============================
    // Notifica√ß√µes
    // ============================
    function mostrarNotificacao(mensagem, tipo = 'info') {
      const cores = {
        success: 'var(--success)',
        warning: 'var(--warning)',
        danger: 'var(--danger)',
        info: 'var(--primary-500)'
      };

      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${cores[tipo] || cores.info};
        color: white;
        padding: var(--space-3) var(--space-4);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-lg);
        z-index: 10000;
        font-size: 0.875rem;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: var(--space-2);
        animation: slideUp 0.3s ease-out;
      `;
      notification.innerHTML = mensagem;
      document.body.appendChild(notification);

      setTimeout(() => {
        notification.style.animation = 'fadeOut 0.3s ease-out forwards';
        setTimeout(() => notification.remove(), 300);
      }, 3000);
    }

    // ============================
    // Sync (outra aba)
    // ============================
    window.addEventListener('storage', (e) => {
      if (e.key === LS.garantias) {
        carregarGarantias();
        atualizarEstatisticas();
      }
      if (e.key === LS.atividadesGarantias) carregarAtividades();
      if (e.key === LS.sidebarCollapsed) restoreSidebarState();
    });
  </script>
</body>
</html>